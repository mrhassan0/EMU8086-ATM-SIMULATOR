.MODEL SMALL
 
.STACK 100H 

;WRITE MACRO 

INPUT MACRO
MOV AH,1
INT 21H
ENDM 

NEWLINE MACRO
MOV DL,10
MOV AH,2
INT 21H
MOV DL,13
MOV AH,2
INT 21H
ENDM


.DATA
PIN db 1,0,4,8,2,3,8,9
BALANCE1 dw 500d
BALANCE2 dw 100d 
USER  db    0d
LOCKED db   0d
COMMAND db  9d ;digit 9 bear no significance 
WELCOMEMSG    db 10,13,  "WELCOME TO SECURE TECH$"
INVALIDMSG    db 10,13, "Invalid PIN..Please Try again$" 
LOCKMSG       db  10,13,"Your ID: **** Has been locked$" 
WELCOMEMSG2      db  10,13,"Welcome User$"
BALANCEMSG       db  10,13,"PRESS: 1 : CHECK BALANACE$"

DEPOSITMSG   db  10,13,"PRESS: 2 : DEPOSIT MONEY$"
WITHDRAWMSG  db   10,13,"PRESS: 3 : WITHDRAW MONEY$"
TRANSACTIONMSG db 10,13,"PRESS: 4 : TRANSACTION LOG$"
LOGOUTMSG      db 10,13,"PRESS: 0 : LOGOUT$" 
KEYMSG         db 10,13, "PRESS KEY: $"
PINMSG         db 10,13, "Please Enter Your PIN: $"    
INP            db ?
.CODE
MAIN PROC

;iniitialize DS

MOV AX,@DATA
MOV DS,AX
;CODE
LEA DX,WELCOMEMSG
CALL PRINT
CALL EPIN



;exit to DOS
               
MOV AX,4C00H
INT 21H

MAIN ENDP 

;WRITE PROC
EPIN PROC 
LEA DX,PINMSG
CALL PRINT ;PRINT PROC CALL
INPUT
MOV INP,AL
SUB AL,48
MOV SI,0
MOV BL,PIN[SI]
MOV SI,4
MOV BH,PIN[SI]
CMP AL,BL
JE  L2                   
CMP AL,BH
JNE L1
JE  L2
L1:
INPUT  ;INPUT MACRO CALL   ;FOR SECURITY FEATURE
INPUT 
INPUT
MOV USER,0d
LEA DX,INVALIDMSG
CALL PRINT  
JMP EXIT

L2:
CALL PINCHECKER 
MOV DL,USER
CMP DL,0
JNE  EXIT
LEA DX,INVALIDMSG
CALL PRINT 

EXIT:  
RET    
EPIN ENDP 

PRINT PROC 
MOV AH,9
INT 21h
RET 
PRINT ENDP 

PINCHECKER PROC  
MOV BL,INP  
SUB BL,48
CMP BL,1
JE  USER1
JNE USER2

USER1:
MOV USER,1d 
MOV SI,1
JMP MAINL
USER2:
MOV USER,2d
MOV SI,5

MAINL:
MOV CL,30h 
PINLOOP:
CMP CL,33h
JGE END
INPUT
SUB AL,48
MOV BH,PIN[SI]
CMP AL,BH
JNE FAKE
JE  REAL
FAKE:
MOV USER,0d
INC CL
INPUT          ;FOR SECURITY FEATURE
INC CL 
INPUT

REAL:
INC SI
INC CL 
JMP PINLOOP
END: 
RET  
PINCHECKER ENDP

END MAIN
